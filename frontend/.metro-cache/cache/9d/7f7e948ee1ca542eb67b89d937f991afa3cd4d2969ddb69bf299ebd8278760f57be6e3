{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":97,"index":97}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"expo-notifications","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":98},"end":{"line":2,"column":52,"index":150}}],"key":"nrBDtkRVez7cBhLzyaRjl+xVfvE=","exportNames":["*"],"imports":1}},{"name":"expo-router","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":192},"end":{"line":4,"column":40,"index":232}}],"key":"/+ErnBisjrT6aDU+GRp5Qz/lYoY=","exportNames":["*"],"imports":1}},{"name":"../services/NotificationService","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":233},"end":{"line":5,"column":66,"index":299}}],"key":"uVOMA4Yk2FxbYrbmyIVcymY71Yo=","exportNames":["*"],"imports":1}},{"name":"./AuthContext","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":6,"column":0,"index":300},"end":{"line":6,"column":40,"index":340}}],"key":"YmpzODa+dVz64UAAYTI+RwJeEt0=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _jsxFileName = \"/app/frontend/context/NotificationContext.tsx\";\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = {};\n    if (e) Object.keys(e).forEach(function (k) {\n      var d = Object.getOwnPropertyDescriptor(e, k);\n      Object.defineProperty(n, k, d.get ? d : {\n        enumerable: true,\n        get: function () {\n          return e[k];\n        }\n      });\n    });\n    n.default = e;\n    return n;\n  }\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  exports.NotificationProvider = NotificationProvider;\n  exports.useNotifications = useNotifications;\n  var _react = require(_dependencyMap[0], \"react\");\n  var _expoNotifications = require(_dependencyMap[1], \"expo-notifications\");\n  var Notifications = _interopNamespace(_expoNotifications);\n  var _expoRouter = require(_dependencyMap[2], \"expo-router\");\n  var _servicesNotificationService = require(_dependencyMap[3], \"../services/NotificationService\");\n  var notificationService = _interopDefault(_servicesNotificationService);\n  var _AuthContext = require(_dependencyMap[4], \"./AuthContext\");\n  var _reactJsxDevRuntime = require(_dependencyMap[5], \"react/jsx-dev-runtime\");\n  const NotificationContext = /*#__PURE__*/(0, _react.createContext)(undefined);\n  function NotificationProvider({\n    children\n  }) {\n    const [expoPushToken, setExpoPushToken] = (0, _react.useState)(null);\n    const [notification, setNotification] = (0, _react.useState)(null);\n    const notificationListener = (0, _react.useRef)();\n    const responseListener = (0, _react.useRef)();\n    const router = (0, _expoRouter.useRouter)();\n    const {\n      user\n    } = (0, _AuthContext.useAuth)();\n    (0, _react.useEffect)(() => {\n      // Register for push notifications when component mounts\n      registerForNotifications();\n\n      // Set up notification listeners\n      notificationListener.current = Notifications.addNotificationReceivedListener(notification => {\n        console.log('ðŸ”” Notification received:', notification);\n        setNotification(notification);\n      });\n      responseListener.current = Notifications.addNotificationResponseReceivedListener(response => {\n        console.log('ðŸ”” Notification response:', response);\n        handleNotificationResponse(response);\n      });\n      return () => {\n        if (notificationListener.current) {\n          Notifications.removeNotificationSubscription(notificationListener.current);\n        }\n        if (responseListener.current) {\n          Notifications.removeNotificationSubscription(responseListener.current);\n        }\n      };\n    }, []);\n\n    // Register token with backend when user logs in\n    (0, _react.useEffect)(() => {\n      if (user && expoPushToken) {\n        notificationService.default.registerTokenWithBackend(user.id, user.role);\n      }\n    }, [user, expoPushToken]);\n    const registerForNotifications = async () => {\n      try {\n        const token = await notificationService.default.registerForPushNotifications();\n        if (token) {\n          setExpoPushToken(token);\n          console.log('ðŸ“± Push token registered:', token);\n        }\n      } catch (error) {\n        console.error('Error registering for notifications:', error);\n      }\n    };\n    const handleNotificationResponse = response => {\n      const data = response.notification.request.content.data;\n\n      // Navigate based on notification type\n      if (data?.screen) {\n        switch (data.screen) {\n          case 'appointments':\n            router.push('/(tabs)/appointments');\n            break;\n          case 'home':\n            router.push('/(tabs)/home');\n            break;\n          case 'admin':\n            router.push('/(tabs)/admin');\n            break;\n          default:\n            break;\n        }\n      }\n    };\n    const scheduleReminder = async (appointmentId, patientName, doctorName, date, time) => {\n      await notificationService.default.scheduleAppointmentReminder(appointmentId, patientName, doctorName, date, time);\n    };\n    const cancelReminder = async appointmentId => {\n      await notificationService.default.cancelAppointmentReminder(appointmentId);\n    };\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(NotificationContext.Provider, {\n      value: {\n        expoPushToken,\n        notification,\n        registerForNotifications,\n        scheduleReminder,\n        cancelReminder\n      },\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 5\n    }, this);\n  }\n  function useNotifications() {\n    const context = (0, _react.useContext)(NotificationContext);\n    if (context === undefined) {\n      throw new Error('useNotifications must be used within a NotificationProvider');\n    }\n    return context;\n  }\n  var _default = NotificationContext;\n});","lineCount":145,"map":[[28,2,134,0,"Object"],[28,8,134,0],[28,9,134,0,"defineProperty"],[28,23,134,0],[28,24,134,0,"exports"],[28,31,134,0],[29,4,134,0,"enumerable"],[29,14,134,0],[30,4,134,0,"get"],[30,7,134,0],[30,18,134,0,"get"],[30,19,134,0],[31,6,134,0],[31,13,134,0,"_default"],[31,21,134,0],[32,4,134,0],[33,2,134,0],[34,2,18,0,"exports"],[34,9,18,0],[34,10,18,0,"NotificationProvider"],[34,30,18,0],[34,33,18,0,"NotificationProvider"],[34,53,18,0],[35,2,126,0,"exports"],[35,9,126,0],[35,10,126,0,"useNotifications"],[35,26,126,0],[35,29,126,0,"useNotifications"],[35,45,126,0],[36,2,1,0],[36,6,1,0,"_react"],[36,12,1,0],[36,15,1,0,"require"],[36,22,1,0],[36,23,1,0,"_dependencyMap"],[36,37,1,0],[37,2,2,0],[37,6,2,0,"_expoNotifications"],[37,24,2,0],[37,27,2,0,"require"],[37,34,2,0],[37,35,2,0,"_dependencyMap"],[37,49,2,0],[38,2,2,0],[38,6,2,0,"Notifications"],[38,19,2,0],[38,22,2,0,"_interopNamespace"],[38,39,2,0],[38,40,2,0,"_expoNotifications"],[38,58,2,0],[39,2,4,0],[39,6,4,0,"_expoRouter"],[39,17,4,0],[39,20,4,0,"require"],[39,27,4,0],[39,28,4,0,"_dependencyMap"],[39,42,4,0],[40,2,5,0],[40,6,5,0,"_servicesNotificationService"],[40,34,5,0],[40,37,5,0,"require"],[40,44,5,0],[40,45,5,0,"_dependencyMap"],[40,59,5,0],[41,2,5,0],[41,6,5,0,"notificationService"],[41,25,5,0],[41,28,5,0,"_interopDefault"],[41,43,5,0],[41,44,5,0,"_servicesNotificationService"],[41,72,5,0],[42,2,6,0],[42,6,6,0,"_AuthContext"],[42,18,6,0],[42,21,6,0,"require"],[42,28,6,0],[42,29,6,0,"_dependencyMap"],[42,43,6,0],[43,2,6,40],[43,6,6,40,"_reactJsxDevRuntime"],[43,25,6,40],[43,28,6,40,"require"],[43,35,6,40],[43,36,6,40,"_dependencyMap"],[43,50,6,40],[44,2,16,0],[44,8,16,6,"NotificationContext"],[44,27,16,25],[44,43,16,28],[44,47,16,28,"createContext"],[44,53,16,41],[44,54,16,41,"createContext"],[44,67,16,41],[44,69,16,79,"undefined"],[44,78,16,88],[44,79,16,89],[45,2,18,7],[45,11,18,16,"NotificationProvider"],[45,31,18,36,"NotificationProvider"],[45,32,18,37],[46,4,18,39,"children"],[47,2,18,73],[47,3,18,74],[47,5,18,76],[48,4,19,2],[48,10,19,8],[48,11,19,9,"expoPushToken"],[48,24,19,22],[48,26,19,24,"setExpoPushToken"],[48,42,19,40],[48,43,19,41],[48,46,19,44],[48,50,19,44,"useState"],[48,56,19,52],[48,57,19,52,"useState"],[48,65,19,52],[48,67,19,68],[48,71,19,72],[48,72,19,73],[49,4,20,2],[49,10,20,8],[49,11,20,9,"notification"],[49,23,20,21],[49,25,20,23,"setNotification"],[49,40,20,38],[49,41,20,39],[49,44,20,42],[49,48,20,42,"useState"],[49,54,20,50],[49,55,20,50,"useState"],[49,63,20,50],[49,65,20,86],[49,69,20,90],[49,70,20,91],[50,4,21,2],[50,10,21,8,"notificationListener"],[50,30,21,28],[50,33,21,31],[50,37,21,31,"useRef"],[50,43,21,37],[50,44,21,37,"useRef"],[50,50,21,37],[50,52,21,43],[50,53,21,44],[51,4,22,2],[51,10,22,8,"responseListener"],[51,26,22,24],[51,29,22,27],[51,33,22,27,"useRef"],[51,39,22,33],[51,40,22,33,"useRef"],[51,46,22,33],[51,48,22,39],[51,49,22,40],[52,4,23,2],[52,10,23,8,"router"],[52,16,23,14],[52,19,23,17],[52,23,23,17,"useRouter"],[52,34,23,26],[52,35,23,26,"useRouter"],[52,44,23,26],[52,46,23,27],[52,47,23,28],[53,4,24,2],[53,10,24,8],[54,6,24,10,"user"],[55,4,24,15],[55,5,24,16],[55,8,24,19],[55,12,24,19,"useAuth"],[55,24,24,26],[55,25,24,26,"useAuth"],[55,32,24,26],[55,34,24,27],[55,35,24,28],[56,4,26,2],[56,8,26,2,"useEffect"],[56,14,26,11],[56,15,26,11,"useEffect"],[56,24,26,11],[56,26,26,12],[56,32,26,18],[57,6,27,4],[58,6,28,4,"registerForNotifications"],[58,30,28,28],[58,31,28,29],[58,32,28,30],[60,6,30,4],[61,6,31,4,"notificationListener"],[61,26,31,24],[61,27,31,25,"current"],[61,34,31,32],[61,37,31,35,"Notifications"],[61,50,31,48],[61,51,31,49,"addNotificationReceivedListener"],[61,82,31,80],[61,83,31,81,"notification"],[61,95,31,93],[61,99,31,97],[62,8,32,6,"console"],[62,15,32,13],[62,16,32,14,"log"],[62,19,32,17],[62,20,32,18],[62,47,32,45],[62,49,32,47,"notification"],[62,61,32,59],[62,62,32,60],[63,8,33,6,"setNotification"],[63,23,33,21],[63,24,33,22,"notification"],[63,36,33,34],[63,37,33,35],[64,6,34,4],[64,7,34,5],[64,8,34,6],[65,6,36,4,"responseListener"],[65,22,36,20],[65,23,36,21,"current"],[65,30,36,28],[65,33,36,31,"Notifications"],[65,46,36,44],[65,47,36,45,"addNotificationResponseReceivedListener"],[65,86,36,84],[65,87,36,85,"response"],[65,95,36,93],[65,99,36,97],[66,8,37,6,"console"],[66,15,37,13],[66,16,37,14,"log"],[66,19,37,17],[66,20,37,18],[66,47,37,45],[66,49,37,47,"response"],[66,57,37,55],[66,58,37,56],[67,8,38,6,"handleNotificationResponse"],[67,34,38,32],[67,35,38,33,"response"],[67,43,38,41],[67,44,38,42],[68,6,39,4],[68,7,39,5],[68,8,39,6],[69,6,41,4],[69,13,41,11],[69,19,41,17],[70,8,42,6],[70,12,42,10,"notificationListener"],[70,32,42,30],[70,33,42,31,"current"],[70,40,42,38],[70,42,42,40],[71,10,43,8,"Notifications"],[71,23,43,21],[71,24,43,22,"removeNotificationSubscription"],[71,54,43,52],[71,55,43,53,"notificationListener"],[71,75,43,73],[71,76,43,74,"current"],[71,83,43,81],[71,84,43,82],[72,8,44,6],[73,8,45,6],[73,12,45,10,"responseListener"],[73,28,45,26],[73,29,45,27,"current"],[73,36,45,34],[73,38,45,36],[74,10,46,8,"Notifications"],[74,23,46,21],[74,24,46,22,"removeNotificationSubscription"],[74,54,46,52],[74,55,46,53,"responseListener"],[74,71,46,69],[74,72,46,70,"current"],[74,79,46,77],[74,80,46,78],[75,8,47,6],[76,6,48,4],[76,7,48,5],[77,4,49,2],[77,5,49,3],[77,7,49,5],[77,9,49,7],[77,10,49,8],[79,4,51,2],[80,4,52,2],[80,8,52,2,"useEffect"],[80,14,52,11],[80,15,52,11,"useEffect"],[80,24,52,11],[80,26,52,12],[80,32,52,18],[81,6,53,4],[81,10,53,8,"user"],[81,14,53,12],[81,18,53,16,"expoPushToken"],[81,31,53,29],[81,33,53,31],[82,8,54,6,"notificationService"],[82,27,54,25],[82,28,54,25,"default"],[82,35,54,25],[82,36,54,26,"registerTokenWithBackend"],[82,60,54,50],[82,61,54,51,"user"],[82,65,54,55],[82,66,54,56,"id"],[82,68,54,58],[82,70,54,60,"user"],[82,74,54,64],[82,75,54,65,"role"],[82,79,54,69],[82,80,54,70],[83,6,55,4],[84,4,56,2],[84,5,56,3],[84,7,56,5],[84,8,56,6,"user"],[84,12,56,10],[84,14,56,12,"expoPushToken"],[84,27,56,25],[84,28,56,26],[84,29,56,27],[85,4,58,2],[85,10,58,8,"registerForNotifications"],[85,34,58,32],[85,37,58,35],[85,43,58,35,"registerForNotifications"],[85,44,58,35],[85,49,58,47],[86,6,59,4],[86,10,59,8],[87,8,60,6],[87,14,60,12,"token"],[87,19,60,17],[87,22,60,20],[87,28,60,26,"notificationService"],[87,47,60,45],[87,48,60,45,"default"],[87,55,60,45],[87,56,60,46,"registerForPushNotifications"],[87,84,60,74],[87,85,60,75],[87,86,60,76],[88,8,61,6],[88,12,61,10,"token"],[88,17,61,15],[88,19,61,17],[89,10,62,8,"setExpoPushToken"],[89,26,62,24],[89,27,62,25,"token"],[89,32,62,30],[89,33,62,31],[90,10,63,8,"console"],[90,17,63,15],[90,18,63,16,"log"],[90,21,63,19],[90,22,63,20],[90,49,63,47],[90,51,63,49,"token"],[90,56,63,54],[90,57,63,55],[91,8,64,6],[92,6,65,4],[92,7,65,5],[92,8,65,6],[92,15,65,13,"error"],[92,20,65,18],[92,22,65,20],[93,8,66,6,"console"],[93,15,66,13],[93,16,66,14,"error"],[93,21,66,19],[93,22,66,20],[93,60,66,58],[93,62,66,60,"error"],[93,67,66,65],[93,68,66,66],[94,6,67,4],[95,4,68,2],[95,5,68,3],[96,4,70,2],[96,10,70,8,"handleNotificationResponse"],[96,36,70,34],[96,39,70,38,"response"],[96,47,70,82],[96,51,70,87],[97,6,71,4],[97,12,71,10,"data"],[97,16,71,14],[97,19,71,17,"response"],[97,27,71,25],[97,28,71,26,"notification"],[97,40,71,38],[97,41,71,39,"request"],[97,48,71,46],[97,49,71,47,"content"],[97,56,71,54],[97,57,71,55,"data"],[97,61,71,59],[99,6,73,4],[100,6,74,4],[100,10,74,8,"data"],[100,14,74,12],[100,16,74,14,"screen"],[100,22,74,20],[100,24,74,22],[101,8,75,6],[101,16,75,14,"data"],[101,20,75,18],[101,21,75,19,"screen"],[101,27,75,25],[102,10,76,8],[102,15,76,13],[102,29,76,27],[103,12,77,10,"router"],[103,18,77,16],[103,19,77,17,"push"],[103,23,77,21],[103,24,77,22],[103,46,77,44],[103,47,77,45],[104,12,78,10],[105,10,79,8],[105,15,79,13],[105,21,79,19],[106,12,80,10,"router"],[106,18,80,16],[106,19,80,17,"push"],[106,23,80,21],[106,24,80,22],[106,38,80,36],[106,39,80,37],[107,12,81,10],[108,10,82,8],[108,15,82,13],[108,22,82,20],[109,12,83,10,"router"],[109,18,83,16],[109,19,83,17,"push"],[109,23,83,21],[109,24,83,22],[109,39,83,37],[109,40,83,38],[110,12,84,10],[111,10,85,8],[112,12,86,10],[113,8,87,6],[114,6,88,4],[115,4,89,2],[115,5,89,3],[116,4,91,2],[116,10,91,8,"scheduleReminder"],[116,26,91,24],[116,29,91,27],[116,35,91,27,"scheduleReminder"],[116,36,92,4,"appointmentId"],[116,49,92,25],[116,51,93,4,"patientName"],[116,62,93,23],[116,64,94,4,"doctorName"],[116,74,94,22],[116,76,95,4,"date"],[116,80,95,16],[116,82,96,4,"time"],[116,86,96,16],[116,91,97,7],[117,6,98,4],[117,12,98,10,"notificationService"],[117,31,98,29],[117,32,98,29,"default"],[117,39,98,29],[117,40,98,30,"scheduleAppointmentReminder"],[117,67,98,57],[117,68,99,6,"appointmentId"],[117,81,99,19],[117,83,100,6,"patientName"],[117,94,100,17],[117,96,101,6,"doctorName"],[117,106,101,16],[117,108,102,6,"date"],[117,112,102,10],[117,114,103,6,"time"],[117,118,104,4],[117,119,104,5],[118,4,105,2],[118,5,105,3],[119,4,107,2],[119,10,107,8,"cancelReminder"],[119,24,107,22],[119,27,107,25],[119,33,107,32,"appointmentId"],[119,46,107,53],[119,50,107,58],[120,6,108,4],[120,12,108,10,"notificationService"],[120,31,108,29],[120,32,108,29,"default"],[120,39,108,29],[120,40,108,30,"cancelAppointmentReminder"],[120,65,108,55],[120,66,108,56,"appointmentId"],[120,79,108,69],[120,80,108,70],[121,4,109,2],[121,5,109,3],[122,4,111,2],[122,24,112,4],[122,28,112,4,"_reactJsxDevRuntime"],[122,47,112,4],[122,48,112,4,"jsxDEV"],[122,54,112,4],[122,56,112,5,"NotificationContext"],[122,75,112,24],[122,76,112,25,"Provider"],[122,84,112,33],[123,6,113,6,"value"],[123,11,113,11],[123,13,113,13],[124,8,114,8,"expoPushToken"],[124,21,114,21],[125,8,115,8,"notification"],[125,20,115,20],[126,8,116,8,"registerForNotifications"],[126,32,116,32],[127,8,117,8,"scheduleReminder"],[127,24,117,24],[128,8,118,8,"cancelReminder"],[129,6,119,6],[129,7,119,8],[130,6,119,8,"children"],[130,14,119,8],[130,16,121,7,"children"],[131,4,121,15],[132,6,121,15,"fileName"],[132,14,121,15],[132,16,121,15,"_jsxFileName"],[132,28,121,15],[133,6,121,15,"lineNumber"],[133,16,121,15],[134,6,121,15,"columnNumber"],[134,18,121,15],[135,4,121,15],[135,11,122,34],[135,12,122,35],[136,2,124,0],[137,2,126,7],[137,11,126,16,"useNotifications"],[137,27,126,32,"useNotifications"],[137,28,126,32],[137,30,126,35],[138,4,127,2],[138,10,127,8,"context"],[138,17,127,15],[138,20,127,18],[138,24,127,18,"useContext"],[138,30,127,28],[138,31,127,28,"useContext"],[138,41,127,28],[138,43,127,29,"NotificationContext"],[138,62,127,48],[138,63,127,49],[139,4,128,2],[139,8,128,6,"context"],[139,15,128,13],[139,20,128,18,"undefined"],[139,29,128,27],[139,31,128,29],[140,6,129,4],[140,12,129,10],[140,16,129,14,"Error"],[140,21,129,19],[140,22,129,20],[140,83,129,81],[140,84,129,82],[141,4,130,2],[142,4,131,2],[142,11,131,9,"context"],[142,18,131,16],[143,2,132,0],[144,2,134,0],[144,6,134,0,"_default"],[144,14,134,0],[144,17,134,15,"NotificationContext"],[144,36,134,34],[145,0,134,35],[145,3]],"functionMap":{"names":["<global>","NotificationProvider","useEffect$argument_0","Notifications.addNotificationReceivedListener$argument_0","Notifications.addNotificationResponseReceivedListener$argument_0","<anonymous>","registerForNotifications","handleNotificationResponse","scheduleReminder","cancelReminder","useNotifications"],"mappings":"AAA;OCiB;YCQ;iFCK;KDG;qFEE;KFG;WGE;KHO;GDC;YCG;GDI;mCKE;GLU;qCME;GNmB;2BOE;GPc;yBQE;GRE;CDe;OUE;CVM"},"hasCjsExports":false},"type":"js/module"}]}